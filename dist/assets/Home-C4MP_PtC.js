import{f as V,c as p,o as l,b as s,t as d,g as H,r as T,h as x,i as L,j as $,k as O,a as r,d as c,e as P,w as f,F as I,l as N,m as z,n as A,p as B,q as i}from"./index-CPnQyNTi.js";import{u as G}from"./news-BAoQvu9z.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as J}from"./TabBar-D23Ha4Ek.js";const K={class:"news-content"},Q={class:"news-title"},W={class:"news-desc"},X={class:"news-info"},Y={class:"news-image"},Z=["src","alt"],ee={__name:"NewsItem",props:{news:{type:Object,required:!0}},setup(o){const t=o,w=V(),h=()=>{w.push(`/news/detail/${t.news.id}`)};return(C,u)=>(l(),p("div",{class:"news-item",onClick:h},[s("div",K,[s("h3",Q,d(o.news.title),1),s("p",W,d(o.news.description),1),s("div",X,[s("span",null,d(o.news.author),1),s("span",null,d(o.news.publishTime),1),s("span",null,d(o.news.views)+" 阅读",1)])]),s("div",Y,[s("img",{src:o.news.image,alt:o.news.title},null,8,Z)])]))}},te=E(ee,[["__scopeId","data-v-deb1e557"]]),ne={class:"home"},se={class:"more-options"},oe={class:"category-tabs"},ae={__name:"Home",setup(o){z(e=>({v3e80dcd0:k.value+"px"}));const t=G(),w=V(),h=A(),{t:C}=H(),u=T(0),k=T(0);x(()=>h.query.categoryId,e=>{if(e){const n=parseInt(e),g=t.categories.filter(v=>v.name!=="更多").findIndex(v=>v.id===n);g!==-1&&(u.value=g,t.changeCategory(n))}},{immediate:!0}),L(()=>{t.getCategories().then(()=>{t.getNewsList()}),setTimeout(b,300),window.addEventListener("scroll",y)});const R=$(()=>t.categories.filter(e=>e.name!=="更多"));$(()=>t.categories.filter(e=>e.name==="军事"||e.name==="科技"||e.name==="财经"));const S=e=>{const m={头条:"headline",社会:"society",国内:"domestic",国际:"international",娱乐:"entertainment",体育:"sports",军事:"military",科技:"technology",财经:"finance",更多:"more"}[e];return m?C(`home.categories.${m}`):e},q=()=>{w.push("/category")},b=()=>{const e=document.querySelector(".van-tabs__wrap");e&&(k.value=e.getBoundingClientRect().top)},y=()=>{b()};L(()=>{t.getNewsList(),setTimeout(b,300),window.addEventListener("scroll",y)}),O(()=>{window.removeEventListener("scroll",y)}),x(u,e=>{const n=t.categories[e].id;t.changeCategory(n)});const M=()=>{t.getNewsList(!0)},U=()=>{t.getNewsList()};return(e,n)=>{const m=c("van-nav-bar"),g=c("van-icon"),v=c("van-list"),j=c("van-pull-refresh"),D=c("van-tab"),F=c("van-tabs");return l(),p("div",ne,[r(m,{title:e.$t("home.title"),fixed:""},null,8,["title"]),s("div",se,[s("div",{class:"more-tab",onClick:q},[P(d(e.$t("home.more"))+" ",1),r(g,{name:"arrow"})])]),s("div",oe,[r(F,{active:u.value,"onUpdate:active":n[2]||(n[2]=_=>u.value=_),sticky:"",swipeable:"",animated:""},{default:f(()=>[(l(!0),p(I,null,N(R.value,(_,ie)=>(l(),B(D,{key:_.id,title:S(_.name),onClick:a=>i(t).changeCategory(_.id)},{default:f(()=>[r(j,{modelValue:i(t).refreshing,"onUpdate:modelValue":n[1]||(n[1]=a=>i(t).refreshing=a),onRefresh:M},{default:f(()=>[r(v,{loading:i(t).loading,"onUpdate:loading":n[0]||(n[0]=a=>i(t).loading=a),finished:i(t).finished,"finished-text":e.$t("home.noMore"),onLoad:U},{default:f(()=>[(l(!0),p(I,null,N(i(t).newsList,a=>(l(),B(te,{key:a.id,news:a},null,8,["news"]))),128))]),_:1},8,["loading","finished","finished-text"])]),_:1},8,["modelValue"])]),_:1},8,["title","onClick"]))),128))]),_:1},8,["active"])]),r(J)])}}},ue=E(ae,[["__scopeId","data-v-9bc6af8c"]]);export{ue as default};
